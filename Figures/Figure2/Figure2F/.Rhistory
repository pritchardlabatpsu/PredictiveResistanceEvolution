pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred_Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sanger.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sanger.df$clin.prev = Sanger.df$abundance/sum(Sanger.df$abundance)
Sanger.df$pred.prev = Sanger.df$pred/sum(Sanger.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sanger.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
axis.lim = 1.05*max(c(Sanger.df$clin.prev,Sanger.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.growpred,intercept=b.growpred,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred_Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sngr.df$clin.prev = Sanger.df$abundance/sum(Sanger.df$abundance)
Sngr.df$pred.prev = Sanger.df$pred/sum(Sanger.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
axis.lim = 1.05*max(c(Sanger.df$clin.prev,Sanger.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.growpred,intercept=b.growpred,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
# ggsave("growpred.pdf",width=6,height=6)
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.Sngr
pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred_Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sngr.df$clin.prev = Sanger.df$abundance/sum(Sanger.df$abundance)
Sngr.df$pred.prev = Sanger.df$pred/sum(Sanger.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
axis.lim = 1.05*max(c(Sanger.df$clin.prev,Sanger.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
# ggsave("growpred.pdf",width=6,height=6)
Sngr.noT315I = Sngr.df[Sngr.df$mutant!="T315I"]
r.Sngr.noT315I = cor(Sngr.noT315I$clin.prev,Sngr.noT315I$pred.prev)
Sngr.noT315I = Sngr.df[Sngr.df$mutant!="T315I",]
r.Sngr.noT315I = cor(Sngr.noT315I$clin.prev,Sngr.noT315I$pred.prev)
r.Sngr.noT315I
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("lmtest")
library("ggplot2")
library("MASS")
library("fitdistrplus")
library("lme4")
library("boot")
# setwd("~/MutationFreq_ABL_IC50/Figures/Figure 3")
setwd("C:/Users/Scott/Box Sync/MutBias/Reresubmit/Figures/Figure3/")
compicmut=read.csv("Combined_data_frame_IC_Mutprob_abundance_withalpha_11_18_2018.csv",header=T,stringsAsFactors=F)
pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred_Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sngr.df$clin.prev = Sanger.df$abundance/sum(Sanger.df$abundance)
pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred_Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
Sngr.noT315I = Sngr.df[Sngr.df$mutant!="T315I",]
r.Sngr.noT315I = cor(Sngr.noT315I$clin.prev,Sngr.noT315I$pred.prev)
axis.lim = 1.05*max(c(Sngr.df$clin.prev,Sngr.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
# ggsave("growpred.pdf",width=6,height=6)
fit2cv.meta = glm.nb(Abundance ~ IC50 + log10(Mutation.Probability),data=compicmut)
rm(list=ls())
pred.on.Sngr = vector(length=nrow(compicmut))
library("ggplot2")
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("lmtest")
library("ggplot2")
library("MASS")
library("fitdistrplus")
library("lme4")
library("boot")
# setwd("~/MutationFreq_ABL_IC50/Figures/Figure 3")
setwd("C:/Users/Scott/Box Sync/MutBias/Reresubmit/Figures/Figure3/")
compicmut=read.csv("Combined_data_frame_IC_Mutprob_abundance_withalpha_11_18_2018.csv",header=T,stringsAsFactors=F)
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
pred_Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred_Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Abundance_Sanger ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Abundance_Sanger,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
Sngr.noT315I = Sngr.df[Sngr.df$mutant!="T315I",]
r.Sngr.noT315I = cor(Sngr.noT315I$clin.prev,Sngr.noT315I$pred.prev)
axis.lim = 1.05*max(c(Sngr.df$clin.prev,Sngr.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
# ggsave("Sanger_2var.pdf",width=6,height=6)
Sngr.wo.meta = compicmut$Abundance_Sanger - compicmut$Abundance
Sngr.wo.meta = compicmut$Abundance_Sanger - compicmut$Abundance
Sngr.removed = Sngr.wo.meta
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.wo.meta = compicmut$Abundance_Sanger - compicmut$Abundance
compicmut$Sngr.removed = Sngr.wo.meta
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
Sngr.noT315I = Sngr.df[Sngr.df$mutant!="T315I",]
r.Sngr.noT315I = cor(Sngr.noT315I$clin.prev,Sngr.noT315I$pred.prev)
axis.lim = 1.05*max(c(Sngr.df$clin.prev,Sngr.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
r.Sngr
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
library("lmtest")
library("ggplot2")
library("MASS")
library("fitdistrplus")
library("lme4")
library("boot")
# setwd("~/MutationFreq_ABL_IC50/Figures/Figure 3")
setwd("C:/Users/Scott/Box Sync/MutBias/Reresubmit/Figures/Figure3/")
compicmut=read.csv("Combined_data_frame_IC_Mutprob_abundance_withalpha_11_18_2018.csv",header=T,stringsAsFactors=F)
Sngr.wo.meta = compicmut$Abundance_Sanger - compicmut$Abundance
compicmut$Sngr.removed = Sngr.wo.meta
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.wo.meta = compicmut$Abundance_Sanger - compicmut$Abundance
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
axis.lim = 1.05*max(c(Sngr.df$clin.prev,Sngr.df$pred.prev))
ggplot(Sngr.df,aes(x=clin.prev,y=pred.prev))+theme_bw()+
geom_abline(slope=1,color="gray75",size=2,linetype=2)+
geom_abline(slope=m.Sngr,intercept=b.Sngr,color="red",size=2)+
geom_point(size=5)+
xlab("Relative Prevalence: Clinically Observed")+ylab("Relative Prevalence: Model Predicted")+
theme(plot.title=element_text(hjust=0.5,size=20,face="bold"),
axis.title=element_text(size=18,face="bold"),
axis.text=element_text(size=16,face="bold",color="black")
)+
xlim(0,axis.lim)+ylim(0,axis.lim)
r.Sngr
set.seed(50)
n.sim = 1e4
r.vec = vector(length=n.sim)
for (n in 1:nsim) {
compicmut$Sngr.removed = Sngr.wo.meta
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
sample(10,1)
i = 1
compicmut$Abundance_Sanger[i]
sample(compicmut$Abundance_Sanger[i],1)
compicmut$Abundance_Sanger>compicmut$Abundance
i = 1
n.removed = sample(compicmut$Abundance[i],1)
n.removed
set.seed(50)
nsim = 1e4
r.vec = vector(length=n.sim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.onSngr = vector(length=nrow(compicmut))
for (i in 1:length(pred_Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
set.seed(50)
nsim = 1e4
r.vec = vector(length=n.sim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
set.seed(50)
nsim = 1e3
r.vec = vector(length=n.sim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
set.seed(50)
nsim = 2
r.vec = vector(length=n.sim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
r.vec
set.seed(50)
nsim = 2
r.vec = vector(length=nsim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
r.vec
set.seed(50)
nsim = 1e3
r.vec = vector(length=nsim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
x=2
x
set.seed(50)
nsim = 15
r.vec = vector(length=nsim)
for (n in 1:nsim) {
Sngr.wo.meta = vector(length=nrow(compicmut))
for (i in 1:length(Sngr.wo.meta)) {
n.removed = sample(compicmut$Abundance[i],1)
Sngr.wo.meta[i] = compicmut$Abundance_Sanger[i] - n.removed
}
compicmut$Sngr.removed = Sngr.wo.meta
pred.on.Sngr = vector(length=nrow(compicmut))
for (i in 1:length(pred.on.Sngr)) {
train = compicmut[-i,]
test = compicmut[i,]
fit2cv_Sngr=glm.nb(Sngr.removed ~ IC50+log10(Mutation.Probability), data=train) #Best 2 variable model
pred.on.Sngr[i] = predict(fit2cv_Sngr, test, type = "response")
}
Sngr.df = data.frame(mutant=compicmut$Compound,abundance=compicmut$Sngr.removed,pred=pred.on.Sngr)
Sngr.df$clin.prev = Sngr.df$abundance/sum(Sngr.df$abundance)
Sngr.df$pred.prev = Sngr.df$pred/sum(Sngr.df$pred)
Sngr.fit = lm(clin.prev~pred.prev,data=Sngr.df)
m.Sngr = Sngr.fit$coefficients[2]
b.Sngr = Sngr.fit$coefficients[1]
r.Sngr = cor(Sngr.df$clin.prev,Sngr.df$pred.prev)
r.vec[n] = r.Sngr
}
r.vec
histogram(r.vec)
hist(r.vec)
ggplot(data.frame(r = r.vec),aes(x=r))+theme_bw()+
geom_histogram()
ggplot(data.frame(r = r.vec),aes(x=r))+theme_bw()+
geom_histogram(bins=5)
